"use strict";const previewName=document.querySelector(".js-preview-name"),previewJob=document.querySelector(".js-preview-job"),previewPhone=document.querySelector(".js-preview-phone"),previewLink=document.querySelector(".js-preview-link"),previewEmail=document.querySelector(".js-preview-email"),previewGithub=document.querySelector(".js-preview-github"),previewPhoto=document.querySelector(".js-preview-photo"),resetBtn=document.querySelector(".js-resetBtn"),form=document.querySelector(".form"),nameJs=document.querySelector(".js-name-input"),jobJs=document.querySelector(".js-job-input"),imgJs=document.querySelector(".js-img-input"),emailJs=document.querySelector(".js-email-input"),linkJs=document.querySelector(".js-link-input"),gitJs=document.querySelector(".js-git-input"),phoneJs=document.querySelector(".js-phone-input"),linkCard=document.querySelector(".link"),create=document.querySelector(".button-create"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js-preview-photo"),collapsableMenu=document.querySelectorAll(".collapsablemenu"),buttonShare=document.querySelector(".button-share"),dataCard={palette:1,name:"Nombre Apellido",job:"Front-End developer",phone:"",email:"",linkedin:"",github:"",photo:"./assets/images/photo2.png"},defaultCheckedPalette=e=>{document.getElementById(""+e.palette).setAttribute("checked","")};defaultCheckedPalette(dataCard);const htmlPreview=e=>{previewName.innerHTML=e.name,previewJob.innerHTML=e.job,previewPhoto.src=e.photo,previewEmail.href="mailto: "+e.email,previewPhone.href="tel: "+e.phone,previewLink.href=e.linkedin,previewGithub.href=e.github,profileImage.style.background=`url(${e.photo})`,profileImage.style.backgroundSize="cover",profilePreview.src=e.photo},fillDataCard=e=>{e&&(dataCard[e.name]=e.value)};function handlePreviewData(e){const t=e.target;fillDataCard(t),htmlPreview(dataCard)}function cardDefault(){dataCard.palette=1,dataCard.name="Nombre Apellido",dataCard.job="Front developer",dataCard.phone="",dataCard.email="",dataCard.linkedin="",dataCard.github="",dataCard.photo="./assets/images/photo2.png"}function resetForm(){dataCard.palette=1,nameJs.value="",jobJs.value="",imgJs.src="",phoneJs.value="",emailJs.value="",linkJs.value="",gitJs.value="",profileImage.style.background=`url(${dataCard.photo})`,profileImage.style.backgroundSize="cover",profileImage.style.backgroundPosition="center"}function resetCard(){cardDefault(),previewName.innerHTML=dataCard.name,previewJob.innerHTML=dataCard.job,previewPhoto.src=dataCard.photo,previewEmail.href=dataCard.email,previewPhone.href="tel: "+dataCard.phone,previewLink.href=dataCard.linkedin,previewGithub.href=dataCard.github,profileImage.style.background=`url(${dataCard.photo})`,profileImage.style.backgroundSize="cover",profileImage.style.backgroundPosition="center",profilePreview.src=dataCard.photo}form.addEventListener("keyup",handlePreviewData);const resetLocalStorage=()=>localStorage.removeItem("userData"),collapseCreateCardSection=()=>{document.querySelector(".button-create").classList.contains("inactived")&&document.querySelector(".button-create").classList.remove("inactived"),document.querySelector(".created").classList.contains("collapsed")||document.querySelector(".created").classList.add("collapsed"),document.querySelector(".check").classList.contains("collapsed")&&document.querySelector(".check").classList.add("collapsed")};function handleClickReset(){resetForm(),resetCard(),document.querySelector(".button-create").classList.contains("inactived")&&document.querySelector(".button-create").classList.remove("inactived"),document.querySelector(".created").classList.contains("collapsed")||document.querySelector(".created").classList.add("collapsed"),document.querySelector(".check").classList.contains("collapsed")&&document.querySelector(".check").classList.add("collapsed"),localStorage.removeItem("userData")}resetBtn.addEventListener("click",handleClickReset);const paletteSelection=e=>{const t=document.querySelector(".card"),a=["palette1","palette2","palette3","palette4"];"palette"===e.name&&(dataCard[e.name]=parseInt(e.id),a.forEach(a=>a==="palette"+e.id?t.classList.add(a):t.classList.remove(a)))},displayCreateCardSection=(e,t)=>{"newCardButton"!==t.name&&"newCardButton"!==t.parentElement.name||(e.preventDefault(),nameJs.value&&jobJs.value&&emailJs.value&&gitJs.value&&linkJs.value?document.querySelector(".created").classList.remove("collapsed"):document.querySelector(".check").classList.remove("collapsed"),document.querySelector(".created").classList.contains("collapsed")||document.querySelector(".button-create").classList.add("inactived"))},arrowPositioner=()=>{collapsableMenu.forEach(e=>e.querySelector(".section-to-hide").classList.contains("collapsed")?e.querySelector(".skull").classList.remove("rotate"):e.querySelector(".skull").classList.add("rotate"))};function menuCollapser(e){e.querySelector(".section-to-hide").classList.toggle("collapsed")}const otherMenusCollapser=e=>{collapsableMenu.forEach(t=>{t.querySelector(".section-to-hide").classList.contains("collapsed")||t===e||t.querySelector(".section-to-hide").classList.add("collapsed")})};function handleFunctionCollapse(e){const t=e.target,a=e.currentTarget;(a===t||t.parentElement.classList.contains("js-legend"))&&(menuCollapser(a),otherMenusCollapser(a),collapsableMenu.forEach(e=>e.querySelector(".section-to-hide").classList.contains("collapsed")?e.querySelector(".skull").classList.remove("rotate"):e.querySelector(".skull").classList.add("rotate"))),paletteSelection(t),displayCreateCardSection(e,t)}function saveDataLocalStorage(){localStorage.setItem("userData",JSON.stringify(dataCard))}function getDataLocalStorage(){const e=JSON.parse(localStorage.getItem("userData"));null!==e&&(nameJs.value=e.name,jobJs.value=e.job,profileImage.style.background=`url(${e.photo})`,profileImage.style.backgroundSize="cover",profileImage.style.backgroundPosition="center",emailJs.value=e.email,linkJs.value=e.linkedin,gitJs.value=e.github,phoneJs.value=e.phone,htmlPreview(e),defaultCheckedPalette(e))}function apiCall(){fetch("https://awesome-profile-cards.herokuapp.com/card",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(dataCard)}).then(e=>e.json()).then(e=>{e.success?(linkCard.innerHTML=e.cardURL,linkCard.href=e.cardURL,buttonShare.href="https://twitter.com/intent/tweet?text=Hello%20world%20mi%20tarjeta&url="+e.cardURL):linkCard.innerHTML="Error"}).catch(e=>{console.error("Se ha producido un error "+e)})}function handleCreatedCard(e){e.preventDefault(),apiCall(),saveDataLocalStorage()}collapsableMenu.forEach(e=>e.addEventListener("click",handleFunctionCollapse)),getDataLocalStorage(),create.addEventListener("click",handleCreatedCard);const newFile=new FileReader,fileField=document.querySelector(".js__profile-upload-btn");function getImage(e){const t=e.currentTarget.files[0];newFile.addEventListener("load",writeImage),newFile.readAsDataURL(t)}function writeImage(){profileImage.style.background=`url(${newFile.result})`,profileImage.style.backgroundSize="cover",profilePreview.src=newFile.result,dataCard.photo=newFile.result}fileField.addEventListener("change",getImage);