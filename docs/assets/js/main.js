"use strict";const previewName=document.querySelector(".js-preview-name"),previewJob=document.querySelector(".js-preview-job"),previewPhone=document.querySelector(".js-preview-phone"),previewLink=document.querySelector(".js-preview-link"),previewEmail=document.querySelector(".js-preview-email"),previewGithub=document.querySelector(".js-preview-github"),previewPhoto=document.querySelector(".js-preview-photo"),resetBtn=document.querySelector(".js-resetBtn"),form=document.querySelector(".form"),nameJs=document.querySelector(".js-name-input"),jobJs=document.querySelector(".js-job-input"),imgJs=document.querySelector(".js-img-input"),emailJs=document.querySelector(".js-email-input"),linkJs=document.querySelector(".js-link-input"),gitJs=document.querySelector(".js-git-input"),phoneJs=document.querySelector(".js-phone-input"),linkCard=document.querySelector(".link"),create=document.querySelector(".button-create"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js-preview-photo"),collapsableMenu=document.querySelectorAll(".collapsablemenu"),buttonShare=document.querySelector(".button-share"),dataCard={palette:1,name:"",job:"",phone:"",email:"",linkedin:"",github:"",photo:"./assets/images/photo2.png"},cardLinkElements=document.querySelectorAll(".card-links");cardLinkElements.forEach(e=>e.removeAttribute("href"));const paletteChecker=e=>{const t=document.getElementById(""+e.palette);document.querySelectorAll(".js-palettes").forEach(e=>e.removeAttribute("checked")),t.setAttribute("checked","")};paletteChecker(dataCard);const htmlPreview=e=>{e.name?previewName.innerHTML=e.name:previewName.innerHTML="Nombre Apellidos",e.job?previewJob.innerHTML=e.job:previewJob.innerHTML="Front-End developer",previewPhoto.src=e.photo,profileImage.style.background=`url(${e.photo})`,profileImage.style.backgroundSize="cover",profilePreview.src=e.photo,e.email&&(previewEmail.href="mailto: "+e.email),e.phone&&(previewPhone.href="tel: "+e.phone),e.linkedin&&(previewLink.href=e.linkedin),e.github&&(previewGithub.href=e.github)},fillDataCard=e=>{dataCard[e.name]=e.value};function handlePreviewData(e){const t=e.target;fillDataCard(t),saveDataLocalStorage(),htmlPreview(dataCard)}function cardDefault(){dataCard.palette=1,dataCard.name="Nombre Apellido",dataCard.job="Front developer",dataCard.phone="",dataCard.email="",dataCard.linkedin="",dataCard.github="",dataCard.photo="./assets/images/photo2.png"}function resetForm(){dataCard.palette=1,nameJs.value="",jobJs.value="",imgJs.src="",phoneJs.value="",emailJs.value="",linkJs.value="",gitJs.value="",profileImage.style.background=`url(${dataCard.photo})`,profileImage.style.backgroundSize="cover",profileImage.style.backgroundPosition="center"}function resetCard(){cardDefault(),previewName.innerHTML=dataCard.name,previewJob.innerHTML=dataCard.job,previewPhoto.src=dataCard.photo,previewEmail.href=dataCard.email,previewPhone.href="tel: "+dataCard.phone,previewLink.href=dataCard.linkedin,previewGithub.href=dataCard.github,profileImage.style.background=`url(${dataCard.photo})`,profileImage.style.backgroundSize="cover",profileImage.style.backgroundPosition="center",profilePreview.src=dataCard.photo}form.addEventListener("keyup",handlePreviewData);const resetLocalStorage=()=>localStorage.removeItem("userData"),collapseCreateCardChildSections=()=>{const e=document.querySelector(".created"),t=document.querySelector(".share-text");document.querySelector(".button-create").classList.contains("inactived")&&document.querySelector(".button-create").classList.remove("inactived"),e.classList.contains("collapsed")||e.classList.add("collapsed"),t.classList.contains("collapsed")||t.classList.add("collapsed")};function handleClickReset(){resetForm(),resetCard(),collapseCreateCardChildSections(),paletteChecker(dataCard),localStorage.removeItem("userData")}resetBtn.addEventListener("click",handleClickReset);const paletteSelection=e=>{const t=document.querySelector(".card"),a=["palette1","palette2","palette3","palette4"];"palette"===e.name&&(dataCard[e.name]=parseInt(e.id),a.forEach(a=>a==="palette"+e.id?t.classList.add(a):t.classList.remove(a)))},chooseWhatMenuDisplay=()=>{event.preventDefault(),nameJs.value&&jobJs.value&&emailJs.value&&gitJs.value&&linkJs.value?document.querySelector(".created").classList.remove("collapsed"):document.querySelector(".check").classList.remove("collapsed"),document.querySelector(".created").classList.contains("collapsed")||document.querySelector(".button-create").classList.add("inactived")},displayCreateCardSection=(e,t)=>{"newCardButton"!==t.name&&"newCardButton"!==t.parentElement.name||chooseWhatMenuDisplay()},arrowPositioner=()=>{collapsableMenu.forEach(e=>e.querySelector(".section-to-hide").classList.contains("collapsed")?e.querySelector(".skull").classList.remove("rotate"):e.querySelector(".skull").classList.add("rotate"))};function menuCollapser(e){e.querySelector(".section-to-hide").classList.toggle("collapsed")}const otherMenusCollapser=e=>{collapsableMenu.forEach(t=>{t.querySelector(".section-to-hide").classList.contains("collapsed")||t===e||t.querySelector(".section-to-hide").classList.add("collapsed")})},checkIsFieldsetOrChild=(e,t)=>{(e===t||t.parentElement.classList.contains("js-legend"))&&(menuCollapser(e),otherMenusCollapser(e),collapsableMenu.forEach(e=>e.querySelector(".section-to-hide").classList.contains("collapsed")?e.querySelector(".skull").classList.remove("rotate"):e.querySelector(".skull").classList.add("rotate")))};function handleFunctionCollapse(e){const t=e.target,a=e.currentTarget;var r;checkIsFieldsetOrChild(a,t),paletteSelection(t),"newCardButton"!==(r=t).name&&"newCardButton"!==r.parentElement.name||chooseWhatMenuDisplay()}function saveDataLocalStorage(){localStorage.setItem("userData",JSON.stringify(dataCard))}function getDataLocalStorage(){const e=JSON.parse(localStorage.getItem("userData"));null!==e&&(paletteChecker(e),nameJs.value=e.name,jobJs.value=e.job,profileImage.style.background=`url(${e.photo})`,profileImage.style.backgroundSize="cover",profileImage.style.backgroundPosition="center",emailJs.value=e.email,linkJs.value=e.linkedin,gitJs.value=e.github,phoneJs.value=e.phone,htmlPreview(e),paletteChecker(e))}function apiCall(){fetch("https://awesome-profile-cards.herokuapp.com/card",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(dataCard)}).then(e=>e.json()).then(e=>{e.success?(linkCard.innerHTML=e.cardURL,linkCard.href=e.cardURL,buttonShare.href="https://twitter.com/intent/tweet?text=Hello%20world%20mi%20tarjeta&url="+e.cardURL):linkCard.innerHTML="Error"}).catch(e=>{console.error("Se ha producido un error "+e)})}function handleCreatedCard(e){e.preventDefault(),apiCall()}collapsableMenu.forEach(e=>e.addEventListener("click",handleFunctionCollapse)),getDataLocalStorage(),create.addEventListener("click",handleCreatedCard);const newFile=new FileReader,fileField=document.querySelector(".js__profile-upload-btn");function handleGetImage(e){const t=e.currentTarget.files[0];newFile.addEventListener("load",writeImage),newFile.readAsDataURL(t)}function writeImage(){profileImage.style.background=`url(${newFile.result})`,profileImage.style.backgroundSize="cover",profilePreview.src=newFile.result,dataCard.photo=newFile.result,saveDataLocalStorage()}fileField.addEventListener("change",handleGetImage);